<!--
 * @Author: zhaoqian.tang
 * @Date: 2021-06-04 15:40:42
 * @LastEditTime: 2021-08-03 15:12:18
 * @LastEditors: Please set LastEditors
 * @Description: 
-->


## 为什么要做监控告警（优先级排序）

1.监控线上问题，出现线上问题能否帮助我们快速定位问题
2.重要页面是否正常运行，运行情况
3.能否提前预见可能发生的问题，根据告警避免一些损失
4.监控系统性能，客观分析系统性能
5.提供一些线上问题主要责任方

## 开源监控告警选型

1.Sentry https://docs.sentry.io/platforms/javascript/ 不支持小程序，需要封装(参考sentry-miniapp) 开源
2.Fundebug https://www.fundebug.com/product 不免费 不开源
3.FrontJS 支持小程序 不开源
4.webfunny_monitor 不支持小程序 开源
5.

重要维度：
1.录像回放，用户报错前操作记录
2.C端数据维度，能够获取哪些重要的数据

## 最终技术选型--sentry
- 支持私有化部署 
- 稳定以及活跃社区
- 已有较多的前端实现
- 较为丰富的数据维度

## 操作流程
1.使用sentry-miniapp在业务中执行
2.封装sentry，能够在业务执行


## sdk项目结构
- constant(基础常量)
- utils(基础方法类)
- src(sentry源sdk)
- entry(o2o前端监控系统入口)


## 遇到问题
1.导出必须使用esmodule支持treeshaking
2.项目结构规划和rollup一些配置 https://github.com/x-dirve/request/blob/master/rollup.config.js
3.esmodule和commonjs混合使用问题
4.小程序使用npm管理依赖问题
5.公司项目中直接引用不生效，只可以export default和放在common下的某个文件夹中


基于 Sentry 的监控告警方案
https://www.yuque.com/u12182749/fpkd23/woabxg

